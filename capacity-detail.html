<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capacity & Beds - Shelford Group Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root { --shelford-teal: #007B7F; --shelford-dark-teal: #005A5D; --shelford-sage: #5B7F6C; --shelford-cream: #FDFBF7; --text-dark: #1A1A1A; --text-mid: #4A4A4A; --border-light: #E5E5E5; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background: var(--shelford-cream); color: var(--text-dark); line-height: 1.6; padding: 2rem; }
        .container { max-width: 1400px; margin: 0 auto; }
        header { display: flex; align-items: center; gap: 2rem; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 3px solid var(--shelford-teal); }
        .logo-link { display: inline-block; } .logo { width: 120px; height: auto; }
        h1 { font-size: 2.5rem; color: var(--shelford-dark-teal); font-weight: 700; }
        .subtitle { font-size: 1.1rem; color: var(--text-mid); margin-top: 0.5rem; }
        h2 { font-size: 1.8rem; color: var(--shelford-dark-teal); margin: 3rem 0 1rem 0; font-weight: 600; }
        h3 { font-size: 1.3rem; color: var(--shelford-dark-teal); margin: 1rem 0; }
        .source-note { font-size: 0.9rem; color: var(--text-mid); margin-top: 0.5rem; margin-bottom: 1.5rem; font-style: italic; }
        nav { background: white; padding: 1rem 2rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,123,127,0.08); }
        nav a { color: var(--shelford-teal); text-decoration: none; font-weight: 500; padding: 0.5rem 1rem; transition: all 0.2s; display: inline-block; }
        nav a:hover { background: rgba(0,123,127,0.1); border-radius: 6px; }
        nav a.active { color: var(--shelford-dark-teal); background: rgba(0,123,127,0.1); border-radius: 6px; font-weight: 600; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
        .metric-card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,123,127,0.08); border-left: 4px solid var(--shelford-teal); }
        .metric-label { font-size: 0.9rem; color: var(--text-mid); margin-bottom: 0.5rem; font-weight: 500; }
        .metric-value { font-size: 2.5rem; color: var(--shelford-dark-teal); font-weight: 700; margin-bottom: 0.25rem; }
        .metric-benchmark { font-size: 0.85rem; color: var(--text-mid); }
        .table-container { background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 2px 8px rgba(0,123,127,0.08); margin-bottom: 3rem; overflow-x: auto; }
        .sort-buttons { margin-bottom: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .sort-btn { padding: 0.5rem 1rem; background: var(--shelford-teal); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s; }
        .sort-btn:hover { background: var(--shelford-dark-teal); } .sort-btn.active { background: var(--shelford-dark-teal); }
        table { width: 100%; border-collapse: collapse; } thead { background: var(--shelford-teal); color: white; }
        th { padding: 1rem; text-align: left; font-weight: 600; } td { padding: 1rem; border-bottom: 1px solid var(--border-light); }
        tbody tr:hover { background: rgba(0,123,127,0.05); } .trust-name { font-weight: 500; }
        .chart-container { background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 2px 8px rgba(0,123,127,0.08); margin-bottom: 3rem; }
        .chart-wrapper { position: relative; height: 400px; margin-top: 1rem; }
        .chart-controls { margin-bottom: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .chart-btn { padding: 0.5rem 1rem; background: var(--shelford-teal); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s; }
        .chart-btn:hover { background: var(--shelford-dark-teal); }
        footer { margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border-light); text-align: center; color: var(--text-mid); font-size: 0.9rem; }
        @media (max-width: 768px) { body { padding: 1rem; } h1 { font-size: 1.8rem; } .metric-value { font-size: 2rem; } .chart-wrapper { height: 300px; } }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="logo-link"><img src="shelford-logo.jpg" alt="Shelford Group" class="logo"></a>
            <div><h1>Capacity &amp; Beds</h1><p class="subtitle">Bed availability and occupancy across Shelford Group trusts</p></div>
        </header>
        <nav><div style="display: flex; gap: 1.5rem; flex-wrap: wrap;">
            <a href="index.html">Overview</a><a href="rtt-detail.html">RTT &amp; Elective Care</a><a href="ae-detail.html">A&amp;E &amp; Urgent Care</a><a href="cancer-detail.html">Cancer Services</a><a href="quality-detail.html">Patient Safety &amp; Quality</a><a href="capacity-detail.html" class="active">Capacity &amp; Beds</a><a href="workforce-detail.html">Workforce</a><a href="research-detail.html">Research &amp; Clinical Trials</a><a href="productivity-detail.html">Productivity</a>
        </div></nav>

        <h2>Capacity Summary</h2>
        <p class="source-note">Source: NHS England KH03 Beds Open Overnight, Q3 2025/26 (October–December 2025), published 19 February 2026. Quarterly average daily beds.</p>
        <div class="dashboard-grid">
            <div class="metric-card"><div class="metric-label">G&amp;A Bed Occupancy (Shelford Weighted Avg)</div><div class="metric-value">89.7%</div><div class="metric-benchmark">Q3 2025/26 · England: 91.5%</div></div>
            <div class="metric-card"><div class="metric-label">G&amp;A Beds Available (Shelford Total)</div><div class="metric-value">14,330</div><div class="metric-benchmark">Average daily, Q3 2025/26</div></div>
            <div class="metric-card"><div class="metric-label">G&amp;A Beds Occupied (Shelford Total)</div><div class="metric-value">12,848</div><div class="metric-benchmark">Average daily, Q3 2025/26</div></div>
        </div>

        <h2>Trust-Level Bed Occupancy</h2>
        <p class="source-note">Source: NHS England KH03 Beds Open Overnight, Q3 2025/26 (October–December 2025), published 19 February 2026</p>
        <div class="table-container">
            <div class="sort-buttons">
                <button class="sort-btn active" onclick="sortTable('alpha', event)">A-Z</button>
                <button class="sort-btn" onclick="sortTable('gaOcc', event)">Sort by G&amp;A Occ</button>
                <button class="sort-btn" onclick="sortTable('totalOcc', event)">Sort by Total Occ</button>
                <button class="sort-btn" onclick="sortTable('availGA', event)">Sort by Beds Available</button>
            </div>
            <table><thead><tr><th>Trust</th><th>G&amp;A Available</th><th>G&amp;A Occupied</th><th>G&amp;A Occupancy</th><th>Total Available</th><th>Total Occupancy</th></tr></thead>
            <tbody id="capacityTableBody"></tbody></table>
        </div>

        <div class="chart-container"><h3>General &amp; Acute Bed Occupancy by Trust</h3>
            <p class="source-note">Source: NHS England KH03 Beds Open Overnight, Q3 2025/26. Average daily beds, October–December 2025.</p>
            <div class="chart-controls"><button class="chart-btn" onclick="sortOccChart('alpha')">A-Z</button><button class="chart-btn" onclick="sortOccChart('highest')">Highest to Lowest</button><button class="chart-btn" onclick="sortOccChart('lowest')">Lowest to Highest</button></div>
            <div class="chart-wrapper"><canvas id="occupancyChart"></canvas></div></div>

        <div class="chart-container"><h3>Bed Capacity – Available vs Occupied (G&amp;A)</h3>
            <p class="source-note">Source: NHS England KH03 Beds Open Overnight, Q3 2025/26. Shows average daily G&amp;A beds available and occupied per trust.</p>
            <div class="chart-wrapper"><canvas id="bedsCompChart"></canvas></div></div>

        <footer><p>&copy; 2026 Shelford Group | Data updated February 2026</p></footer>
    </div>

    <script>
        // All data from NHS England KH03 Beds Open Overnight, Q3 2025/26
        // Published 19 February 2026
        const capacityData = [
            { name: 'Birmingham', availGA: 2769, occGA: 2675, gaOcc: 96.6, availTotal: 2886, totalOcc: 96.6 },
            { name: 'Cambridge', availGA: 1044, occGA: 952, gaOcc: 91.2, availTotal: 1105, totalOcc: 90.6 },
            { name: 'GSTT', availGA: 1210, occGA: 1005, gaOcc: 83.1, availTotal: 1286, totalOcc: 83.1 },
            { name: 'Imperial', availGA: 1039, occGA: 982, gaOcc: 94.6, availTotal: 1093, totalOcc: 94.6 },
            { name: "King's", availGA: 1357, occGA: 1201, gaOcc: 88.5, availTotal: 1477, totalOcc: 85.7 },
            { name: 'Manchester', availGA: 2067, occGA: 1842, gaOcc: 89.1, availTotal: 2276, totalOcc: 87.7 },
            { name: 'Newcastle', availGA: 1458, occGA: 1214, gaOcc: 83.3, availTotal: 1565, totalOcc: 80.4 },
            { name: 'Oxford', availGA: 1019, occGA: 923, gaOcc: 90.5, availTotal: 1096, totalOcc: 88.7 },
            { name: 'Sheffield', availGA: 1515, occGA: 1382, gaOcc: 91.2, availTotal: 1633, totalOcc: 89.5 },
            { name: 'UCLH', availGA: 853, occGA: 672, gaOcc: 78.9, availTotal: 897, totalOcc: 77.4 }
        ];

        function sortTable(sortType, e) {
            let sorted = [...capacityData];
            if (sortType === 'gaOcc') sorted.sort((a,b) => b.gaOcc - a.gaOcc);
            else if (sortType === 'totalOcc') sorted.sort((a,b) => b.totalOcc - a.totalOcc);
            else if (sortType === 'availGA') sorted.sort((a,b) => b.availGA - a.availGA);
            document.getElementById('capacityTableBody').innerHTML = sorted.map(t =>
                '<tr><td class="trust-name">'+t.name+'</td><td>'+t.availGA.toLocaleString()+'</td><td>'+t.occGA.toLocaleString()+'</td><td>'+t.gaOcc+'%</td><td>'+t.availTotal.toLocaleString()+'</td><td>'+t.totalOcc+'%</td></tr>'
            ).join('');
            if (e) { document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active')); e.target.classList.add('active'); }
        }
        sortTable('alpha', null);

        // G&A Occupancy bar chart
        const occData = { labels: capacityData.map(d=>d.name), values: capacityData.map(d=>d.gaOcc) };
        let occupancyChart = new Chart(document.getElementById('occupancyChart'), { type: 'bar', data: { labels: occData.labels, datasets: [{ label: 'G&A Bed Occupancy %', data: occData.values, backgroundColor: '#007B7F', borderRadius: 6 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, annotation: {} }, scales: { y: { beginAtZero: false, min: 70, max: 100, ticks: { callback: v => v+'%' } } } } });
        function sortOccChart(sortType) {
            let indices = occData.labels.map((_,i) => i);
            if (sortType === 'highest') indices.sort((a,b) => occData.values[b] - occData.values[a]);
            else if (sortType === 'lowest') indices.sort((a,b) => occData.values[a] - occData.values[b]);
            occupancyChart.data.labels = indices.map(i => occData.labels[i]);
            occupancyChart.data.datasets[0].data = indices.map(i => occData.values[i]);
            occupancyChart.update();
        }

        // Available vs Occupied stacked/grouped bar
        new Chart(document.getElementById('bedsCompChart'), { type: 'bar', data: { labels: capacityData.map(d=>d.name), datasets: [{ label: 'G&A Occupied', data: capacityData.map(d=>d.occGA), backgroundColor: '#007B7F', borderRadius: 6 },{ label: 'G&A Unoccupied', data: capacityData.map(d=>d.availGA - d.occGA), backgroundColor: '#94A3B8', borderRadius: 6 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top' }, tooltip: { callbacks: { footer: items => { const i = items[0].dataIndex; return 'Total available: '+capacityData[i].availGA.toLocaleString()+' | Occupancy: '+capacityData[i].gaOcc+'%'; } } } }, scales: { x: { stacked: true }, y: { stacked: true, ticks: { callback: v => v.toLocaleString() } } } } });
    </script>
</body>
</html>
